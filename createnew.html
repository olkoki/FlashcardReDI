<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Flashcard Creator</title>
  <!-- <link rel="stylesheet" href="createnew1.css"> -->
  <link rel="icon" href="./favicon.ico" type="image/x-icon">

  <style>
    body {
      background-color: #fff;
      font-family: Arial, sans-serif;
      padding: 0;
      margin: 0;

    }

    h1 {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 4px 0;
      margin: 0 0;
      background: #fff;
      color:#8aa2ce;
    }

    h2 {
      color: rgb(255, 255, 255);
      text-align: left;
      padding: 0;
      margin: 0;

      background: #8aa2ce;

    }

    /* Container for left and right sections */
    .container {
      display: flex;
      gap: 30px;
      padding: 20px;
      justify-content: center;
      height: 80vh;
    }

    /* Left form section */
    .form-section {
      background: #8aa2ce;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      flex: 1;
      border: 1px solid #864508;
    }

    /* Right preview section */
    .preview-section {

      background: #8aa2ce;
      /* padding: 0; */
      /* padding: 10px; */
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      /* overflow-y: auto; */
      flex: 1;
      max-height: 80vh;
      border: 1px solid #864508;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Labels and inputs */
    label {
      display: block;
      text-align: left;
      margin: 15px 0 5px;
      font-weight: bold;
    }

    input[type="text"],
    select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #1a097a;
      border-radius: 5px;
      box-sizing: border-box;
      cursor: pointer;

    }

    /* Buttons */
    button {
      font-family: Arial, sans-serif;
      border: 1px solid #333;
      padding: 8px 16px;
      margin: 8px;
      background-color: #f0f0f0;
      color: black;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #a4adbb;
      /* It chnages the color of the button when cursor is pointed*/
    }


    /* Status message */
    #status {
      margin-top: 15px;
      font-weight: bold;
    }

    /* Success message */
    .status-success {
      color: green;
    }

    /* Error message */
    .status-error {
      color: red;
    }

    /* Flashcard preview styling */
    .card {
      background: white;
      border-left: 5px solid #d37474;
      padding: 1px;
      margin-bottom: 15px;
      border-radius: 8px;
      text-align: left;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      border: 5px solid #937de6;
    }

    .card p {
      margin: 5px 0;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        gap: 20px;
        padding: 20px;
      }

      .form-section,
      .preview-section {
        max-width: 100%;
      }
    }

    input[type="file"] {
      padding: 6px;
      border: 1px solid #333;
      border-radius: 5px;
      background-color: #f0f0f0;
      color: black;
      cursor: pointer;
      font-weight: bold;
    }

    input[type="file"]::file-selector-button {
      padding: 6px 12px;
      border: 1px solid #333;
      border-radius: 5px;
      background-color: #f0f0f0;
      color: black;
      cursor: pointer;
      font-weight: bold;
    }

    input[type="file"]::file-selector-button:hover {
      background-color: #a4adbb;
    }

    .edit-btn {
      margin-right: 10px;
      background-color: #cbf8e2;
      color: black;
    }

    .del-btn {
      background-color: #e6bdbd;
      color: black;
    }

    .card-count {

      color: white;
      font-weight: bold;
    }

    #card-count {
      text-align: left;
    }

    .sticky-header {
      position: sticky;
      top: 0;
      background: #8aa2ce;
      z-index: 1;
      padding: 10px 20px;
      margin: 0;
      /* border-bottom: 1px solid #333; */
    }

    .card-container {
      overflow-y: auto;
      flex: 1;
      padding: 10px 20px;
    }

    /* Add a black background color to the top navigation */
    .topnav {
      background-color: #6cabc1;
      overflow: hidden;
      width: 100%;
    }

    .topnav p {
      color: white;
      font-size: 1rem;
      margin: 0;
      padding: 14px 16px;
      text-align: center;
      font-weight: bold;
    }

    /* Style the links inside the navigation bar */
    .topnav a {
      float: left;
      display: block;
      color: #f2f2f2;
      text-align: center;
      padding: 14px 16px;
      padding-left: 5%;
      padding-right: 5%;
      text-decoration: none;
      font-size: 17px;
    }

    /* Change the color of links on hover */
    .topnav a:hover {
      background-color: #f15a22;
      color: white;
    }

    /* Add an active class to highlight the current page */
    .topnav a.active {
      background-color: #2ecc71;
      color: white;
    }

    /* Hide the link that should open and close the topnav on small screens */
    .topnav .icon {
      display: none;
    }

    /* When the screen is less than 600 pixels wide, hide all links, except for the first one ("Home"). Show the link that contains should open and close the topnav (.icon) */
    @media screen and (max-width: 600px) {
      .topnav a:not(:first-child) {
        display: none;
      }

      .topnav a.icon {
        float: right;
        display: block;
      }
    }

    /* The "responsive" class is added to the topnav with JavaScript when the user clicks on the icon. This class makes the topnav look good on small screens (display the links vertically instead of horizontally) */
    @media screen and (max-width: 600px) {
      .topnav.responsive {
        position: relative;
      }

      .topnav.responsive a.icon {
        position: absolute;
        right: 0;
        top: 0;
      }

      .topnav.responsive a {
        float: none;
        display: block;
        text-align: left;
      }
    }



    /* When the screen is less than 600 pixels wide, hide all links, except for the first one ("Home"). Show the link that contains should open and close the topnav (.icon) */
    @media screen and (max-width: 768px) {
      .topnav a:not(:first-child) {
        display: none;
      }

      .topnav a.icon {
        float: right;
        display: block;
      }

      .card {
        padding: 1.5rem;
        font-size: 1rem;
      }

      .buttons-container {
        flex-direction: column;
        gap: 10px;
      }

      .buttons-container button {
        width: 100%;
      }
    }

    /* The "responsive" class is added to the topnav with JavaScript when the user clicks on the icon. This class makes the topnav look good on small screens (display the links vertically instead of horizontally) */
    @media screen and (max-width: 480px) {
      .topnav.responsive {
        position: relative;
      }

      .topnav.responsive a.icon {
        position: absolute;
        right: 0;
        top: 0;
      }

      .topnav.responsive a {
        float: none;
        display: block;
        text-align: left;
      }
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      border: 2px solid #888;
      width: 90%;
      max-width: 400px;
      border-radius: 10px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: black;
    }
  </style>
</head>

<body>
  <div class="topnav" id="myTopnav">
    <a href="createnew3.html" class="active">Create a Deck</a>
    <a href="learning.html">Learning</a>
    <p>Lovely Flashcards</p>
    <a href="javascript:void(0);" class="icon" onclick="myFunction()">
      <i class="fa fa-bars"></i>
    </a>
  </div>
  <h1>Create a Lovely Flashcards</h1>
  <div class="container">
    <!-- Left: Form Section -->
    <div class="form-section">
      <label for="question">Question:</label>
      <input id="question" type="text" placeholder="Enter a question">
      <label for="answer">Answer:</label>
      <input id="answer" type="text" placeholder="Enter a answer">
      <label for="difficulty">Difficulty:</label>
      <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
      <label for="category">Category:</label>
      <input id="category" type="text" placeholder="e.g. Math, Science">
      <button onclick="savecard()">Save</button>
      <button onclick="downloadcards()">Download</button>
      <button onclick="removeDuplicateQuestions()">Remove Duplicates</button>
      <!-- Optional file upload -->
      <input type="file" id="upload" onchange="uploadCards(event)" accept=".json">
      <div id="status"></div>
    </div>


    <!-- Preview Section -->
    <div class="preview-section">
      <h2 class="sticky-header">Flashcard Preview</h2>

      <p class="card-count sticky-header" id="card-count">Total Cards: 0</p> <!-- Counter -->
      <div class="card-container" id="preview"></div>
    </div>
  </div>
  <!-- Edit Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h3>Edit Flashcard</h3>
      <label for="editQuestion">Question:</label>
      <input type="text" id="editQuestion">

      <label for="editAnswer">Answer:</label>
      <input type="text" id="editAnswer">

      <label for="editDifficulty">Difficulty:</label>
      <select id="editDifficulty">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>

      <label for="editCategory">Category:</label>
      <input type="text" id="editCategory">

      <button onclick="saveEdit()">Save Changes</button>
    </div>
  </div>

  <script>
    document.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener('click', event => {
        event.preventDefault();
        const target = link.getAttribute('href').substring(1);
        // Hide all sections
        document.querySelectorAll('.section').forEach(s => s.style.display = 'none');

        // Show the target section

        document.getElementById(target).style.display = 'block';

        // Update active class on nav links
        document.querySelectorAll('.topnav a').forEach(a => a.classList.remove('active'));
        link.classList.add('active');
      });
    });

    let flashcards = JSON.parse(localStorage.getItem("flashcards")) || [];

    function showStatus(message, isError = false) {
      const status = document.getElementById("status");
      status.textContent = message;
      status.style.color = isError ? "red" : "white";

      setTimeout(() => {
        status.textContent = "";
      }, 3000);
    }

    function clearForm() {
      document.getElementById("question").value = "";
      document.getElementById("answer").value = "";
      document.getElementById("difficulty").value = "easy";
      document.getElementById("category").value = "";
    }

    function savecard() {
      const question = document.getElementById("question").value.trim();
      const answer = document.getElementById("answer").value.trim();
      const difficulty = document.getElementById("difficulty").value;
      const category = document.getElementById("category").value.trim();

      if (question && answer) {

        flashcards.push({ question, answer, difficulty, category });
        localStorage.setItem("flashcards", JSON.stringify(flashcards));
        showStatus("✅ Flashcard saved");

        // Clear inputs
        //document.getElementById("question").value="";
        //document.getElementById("answer").value="";
        //document.getElementById("category").value = "";
        clearForm();
        //  Only render the flashcard if it's valid (display flashcards as soon as they’re added)
        renderCard({ question, answer, difficulty, category }, flashcards.length - 1);
        updateCardCount();
      } else {
        showStatus("❌ Please fill both fields");

      }

    }
    function renderCard(card, index) {
      const preview = document.getElementById("preview");

      const cardDiv = document.createElement("div");
      cardDiv.className = "card";

      const q = document.createElement("p");
      q.innerHTML = `<strong>Question:</strong> ${card.question}`;

      const a = document.createElement("p");
      a.innerHTML = `<strong>Answer:</strong> ${card.answer}`;

      const d = document.createElement("p");
      d.innerHTML = `<strong>Difficulty:</strong> ${card.difficulty}`;

      const c = document.createElement("p");
      c.innerHTML = `<strong>Category:</strong> ${card.category || "N/A"}`;

      //Edit Button
      const editBtn = document.createElement("button");
      editBtn.textContent = "✏️ Edit";
      editBtn.className = "edit-btn"; // Apply your CSS styles
      // Edit button click handler
      editBtn.onclick = function () {
        openModal(card, index); // <- this shows the modal and loads data
      };


      //  Delete Button
      const delBtn = document.createElement("button");
      delBtn.textContent = "🗑️ Delete";
      delBtn.className = "del-btn"; // Apply your CSS styles
      // Delete button click handler
      delBtn.onclick = function () {
        const confirmDelete = confirm("Are you sure you want to delete this card?");
        if (confirmDelete) {
          cardDiv.style.opacity = "0"; // Start fade out
          setTimeout(() => {
            flashcards.splice(index, 1);
            localStorage.setItem("flashcards", JSON.stringify(flashcards));
            updatePreview();
            updateCardCount();
            showStatus("✅ Card deleted successfully."); // <-- Status message here
          }, 300); // Wait for animation
        }
      };

      // Append all elements to card container
      cardDiv.appendChild(q);
      cardDiv.appendChild(a);
      cardDiv.appendChild(d);
      cardDiv.appendChild(c);
      cardDiv.appendChild(editBtn);
      cardDiv.appendChild(delBtn);
      preview.prepend(cardDiv); // added card appears on the top

      //   preview.appendChild(cardDiv); (to add cards at the end)
    }

    // Download flashcards as a JSON file
    function downloadcards() {
      const blob = new Blob([JSON.stringify(flashcards)], { type: "application/json" });
      const url = URL.createObjectURL(blob);


      const link = document.createElement("a");
      link.href = url;
      link.download = "flashcards.json";
      link.click();
      URL.revokeObjectURL(url);
      setTimeout(() => {
        showStatus("✅ File Downloaded successfully");
      }, 1000);
    }

    // Clear preview area and render all flashcards
    function updatePreview() {
      const preview = document.getElementById("preview");
      preview.innerHTML = ""; // Clear all cards
      flashcards.forEach(renderCard);// Render each card
      updateCardCount();
    }

    let editIndex = null;

    function openModal(card, index) {
      editIndex = index;

      document.getElementById("editQuestion").value = card.question;
      document.getElementById("editAnswer").value = card.answer;
      document.getElementById("editDifficulty").value = card.difficulty;
      document.getElementById("editCategory").value = card.category;

      document.getElementById("editModal").style.display = "block";
    }

    function closeModal() {
      document.getElementById("editModal").style.display = "none";
    }

    function saveEdit() {
      const question = document.getElementById("editQuestion").value.trim();
      const answer = document.getElementById("editAnswer").value.trim();
      const difficulty = document.getElementById("editDifficulty").value;
      const category = document.getElementById("editCategory").value.trim();

      if (question && answer) {
        flashcards[editIndex] = { question, answer, difficulty, category };
        localStorage.setItem("flashcards", JSON.stringify(flashcards));
        updatePreview(); // re-render the updated cards
        closeModal();
        showStatus("✅ Flashcard updated.");
      } else {
        alert("❌ Question and Answer cannot be empty.");
      }
    }


    // Upload flashcards from a JSON file input
    function uploadCards(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (e) {
        try {
          const uploaded = JSON.parse(e.target.result);
          // Only accept if uploaded data is an array
          if (Array.isArray(uploaded)) {
            flashcards = flashcards.concat(uploaded);
            removeDuplicateQuestions();// no dulicate cards will be uploaded
            localStorage.setItem("flashcards", JSON.stringify(flashcards));
            updatePreview();
            updateCardCount();
            showStatus("✅ Flashcards uploaded successfully.");

          } else {
            showStatus("❌Invalid file format.");
          }
        } catch (err) {

          showStatus("❌ Error reading file.");

        }
      };

      reader.readAsText(file);
    }
    // Remove flashcards with duplicate questions (case-insensitive)
    function removeDuplicateQuestions() {

      const seen = new Set();
      const uniqueCards = [];

      for (const card of flashcards) {
        const q = card.question.trim().toLowerCase();
        if (!seen.has(q)) {
          seen.add(q);
          uniqueCards.push(card);
        }
      }
      flashcards = uniqueCards;// Update global flashcards array
      localStorage.setItem("flashcards", JSON.stringify(flashcards));// Save unique cards

      updatePreview();
      updateCardCount();

      showStatus("✅ Duplicates removed.");

    }
    function updateCardCount() {
      const countElement = document.getElementById("card-count");
      countElement.textContent = `Total Cards: ${flashcards.length}`;
    }
    // Load and preview on page load
    updatePreview();

  </script>
  <!-- <script src="createnew1.js"></script> -->
</body>

</html>
